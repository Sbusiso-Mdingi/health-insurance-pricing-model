# --------------------------------------------------
# Model Training for Health Insurance Pricing
# --------------------------------------------------
# This script trains frequency (Poisson) and severity (Lognormal)
# models on the synthetic health insurance dataset and saves the models.
# --------------------------------------------------
library(dplyr)
library(splines)
library(MASS)
library(broom)
# --------------------------------------------------
# LOAD DATA
# --------------------------------------------------
insurance_data <- read.csv("data/synthetic_health_insurance_data.csv")
# Set working directory to the project folder
setwd("~/Documents/health-insurance-pricing-model")
# Set working directory to the project folder
setwd("~/Documents/GitHub/health-insurance-pricing-model")
# --------------------------------------------------
# LOAD DATA
# --------------------------------------------------
insurance_data <- read.csv("data/synthetic_health_insurance_data.csv")
# --------------------------------------------------
# Model Training for Health Insurance Pricing
# --------------------------------------------------
# This script trains frequency (Poisson) and severity (Lognormal)
# models on the synthetic health insurance dataset and saves the models.
# --------------------------------------------------
library(dplyr)
library(splines)
library(MASS)
library(broom)
# --------------------------------------------------
# LOAD DATA
# --------------------------------------------------
insurance_data <- read.csv("data/synthetic_health_insurance_data.csv")
# --------------------------------------------------
# FREQUENCY MODEL (Poisson)
# --------------------------------------------------
freq_model <- glm(
ClaimCount ~ ns(Age, df = 4) + ns(BMI, df = 4) + Sex + Smoker + Children + Region,
data = insurance_data,
family = poisson(link = "log")
)
# Save frequency model
saveRDS(freq_model, "models/freq_model.rds")
# --------------------------------------------------
# Model Training for Health Insurance Pricing
# --------------------------------------------------
# This script trains frequency (Poisson) and severity (Lognormal)
# models on the synthetic health insurance dataset and saves the models.
# --------------------------------------------------
library(dplyr)
library(splines)
library(MASS)
library(broom)
# --------------------------------------------------
# LOAD DATA
# --------------------------------------------------
insurance_data <- read.csv("data/synthetic_health_insurance_data.csv")
# --------------------------------------------------
# FREQUENCY MODEL (Poisson)
# --------------------------------------------------
freq_model <- glm(
ClaimCount ~ ns(Age, df = 4) + ns(BMI, df = 4) + Sex + Smoker + Children + Region,
data = insurance_data,
family = poisson(link = "log")
)
# Save frequency model
saveRDS(freq_model, "models/freq_model.rds")
# --------------------------------------------------
# SEVERITY MODEL (Lognormal)
# --------------------------------------------------
# Subset for policyholders with at least one claim
sev_data <- insurance_data %>% filter(ClaimCount > 0)
# Fit lognormal regression on log(Charges)
sev_model <- lm(
log(Charges) ~ ns(Age, df = 4) + ns(BMI, df = 4) + Sex + Smoker + Children + Region,
data = sev_data
)
# Estimate residual standard deviation (sigma)
sigma_hat <- summary(sev_model)$sigma
# Save severity model and sigma
saveRDS(sev_model, "models/sev_model.rds")
saveRDS(sigma_hat, "models/sigma_hat.rds")
# --------------------------------------------------
# END OF SCRIPT
# --------------------------------------------------
